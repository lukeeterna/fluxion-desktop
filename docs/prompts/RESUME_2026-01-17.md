# FLUXION - Prompt Ripresa Sessione 2026-01-17

## Contesto Rapido

**Progetto**: FLUXION - Gestionale desktop PMI (Tauri 2.x + React 19 + Rust + SQLite)
**Fase Corrente**: 7.5 - Supplier Management + Testing
**Ultimo Update**: 2026-01-16

---

## Stato Macchine

| Macchina | macOS | Tauri 2.9.5 | Note |
|----------|-------|-------------|------|
| **iMac** | 12.7.4 (Monterey) | ✅ Funziona | Usare per sviluppo |
| MacBook | 11.7.10 (Big Sur) | ❌ Crash | API WebKit mancanti |

**SSH iMac**: `ssh imac` (192.168.1.2)
**Path iMac**: `/Volumes/MacSSD - Dati/fluxion`

---

## Cosa Fare Oggi

### 1. Test Invio Ordini (Priorità ALTA)

**Dove**: iMac (`ssh imac`)
**Come avviare**:
```bash
cd '/Volumes/MacSSD - Dati/fluxion'
npm run tauri dev
```

**Test Email**:
1. Vai a Fornitori → Ordini
2. Clicca icona Email su un ordine
3. Verifica che appare SendConfirmDialog con preview
4. Clicca "Conferma Invio" → deve aprire client email

**Test WhatsApp**:
1. Clicca icona WhatsApp su un ordine
2. Verifica SendConfirmDialog con preview
3. Clicca "Conferma Invio" → deve aprire wa.me URL

**File da controllare se non funziona**:
- `src/pages/Fornitori.tsx` (handleConfirmSend)
- `src/components/fornitori/SendConfirmDialog.tsx`

---

### 2. Test Voice Agent Sara (Priorità MEDIA)

**Prerequisiti**:
```bash
cd voice-agent
pip install -r requirements.txt
python scripts/download_models.py --all
```

**Avvio**:
```bash
python main.py  # Porta 3002
```

**Test**:
1. Avvia Fluxion su iMac
2. Apri Voice Assistant dalla sidebar
3. Parla: "Buongiorno, vorrei prenotare un appuntamento"
4. Verifica: Sara chiede nome cliente

**File da controllare se non funziona**:
- `voice-agent/src/orchestrator.py`
- `voice-agent/src/tts.py`
- `voice-agent/src/nlu/italian_nlu.py`

---

### 3. Test WhatsApp QR Scan (Priorità MEDIA)

**Prerequisiti**: WhatsApp service deve essere avviato

**Test**:
1. Apri Impostazioni → WhatsApp
2. Clicca "Scansiona QR"
3. Verifica che appare QR code
4. Scansiona con telefono

**File da controllare**:
- `src/components/whatsapp/WhatsAppQRScan.tsx`
- `scripts/whatsapp-service.cjs`

---

## Architettura Rilevante

### Comunicazione Fornitori

```
[OrderDialog] → handleSendEmail/handleSendWhatsApp
      ↓
[SendConfirmDialog] → preview messaggio
      ↓
[handleConfirmSend] → window.open(mailto:/wa.me) + log interaction
```

### Voice Agent Pipeline

```
[VoiceUI] → HTTP :3002 → [Python Server]
                              ↓
                    [Whisper STT] → text
                              ↓
                    [NLU 4-layer] → intent + entities
                              ↓
                    [Orchestrator] → risposta
                              ↓
                    [Piper TTS] → audio
```

---

## File Principali Modificati Ieri

| File | Descrizione |
|------|-------------|
| `src/pages/Fornitori.tsx` | Pagina completa con conferma invio |
| `src/hooks/use-file-parser.ts` | Excel/Word parser con auto-detect |
| `src/components/fornitori/SendConfirmDialog.tsx` | Dialog conferma Email/WA |
| `src-tauri/src/commands/supplier.rs` | Fix tipo `items: String` |

---

## Comandi Utili

```bash
# Sync codice su iMac
tar --exclude='target' --exclude='node_modules' --exclude='.git' -cf - . | ssh imac "cd '/Volumes/MacSSD - Dati/fluxion' && tar -xf -"

# TypeScript check
npx tsc --noEmit

# Avvio su iMac
ssh imac "cd '/Volumes/MacSSD - Dati/fluxion' && npm run tauri dev"

# Check Voice Agent
curl http://localhost:3002/health

# Check HTTP Bridge
curl http://localhost:3001/health
```

---

## Riferimenti

- **CLAUDE.md**: Stato progetto completo
- **SESSION-HISTORY.md**: Cronologia sessioni
- **FLUXION-ORCHESTRATOR.md**: Procedure operative

---

## Checklist Fine Giornata

- [ ] Test invio Email completato
- [ ] Test invio WhatsApp completato
- [ ] Test Voice Agent completato
- [ ] Test WhatsApp QR Scan completato
- [ ] Aggiornare CLAUDE.md con risultati
- [ ] Commit con riepilogo

---

*Generato: 2026-01-16T21:00:00*
