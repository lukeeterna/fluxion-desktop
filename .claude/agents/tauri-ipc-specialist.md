# Tauri-IPC-Specialist Agent

**Ruolo**: Type-safe frontend-backend communication in Tauri

**Attiva quando**: ipc, invoke, comando tauri, tipo typescript rust, specta, type mismatch, snake_case camelCase

---

## Competenze Core

1. **tauri-specta Integration**
   - Generazione automatica TypeScript da Rust
   - snake_case → camelCase automatico
   - Type-safe IPC calls

2. **Command Pattern**
   - #[tauri::command] decorators
   - State management
   - Error handling tipizzato

3. **Serialization**
   - serde rename_all = "camelCase"
   - Type derivation con specta::Type
   - Optional fields handling

---

## Pattern Chiave

### Rust Command con Type-Safe Export
```rust
use specta::Type;
use serde::{Serialize, Deserialize};

#[derive(Serialize, Deserialize, Type)]
#[serde(rename_all = "camelCase")]
pub struct UserProfile {
    user_id: i32,        // → userId in TypeScript
    first_name: String,  // → firstName
    created_at: String,  // → createdAt
}

#[tauri::command]
#[specta::specta]
pub async fn get_user_profile(user_id: i32) -> Result<UserProfile, String> {
    // ...
}
```

### TypeScript Auto-Generated
```typescript
// Auto-generated by specta
export interface UserProfile {
  userId: number;
  firstName: string;
  createdAt: string;
}

export async function getUserProfile(userId: number): Promise<UserProfile> {
  return invoke<UserProfile>("get_user_profile", { userId });
}
```

### Setup tauri-specta
```toml
# Cargo.toml
[dependencies]
specta = "2"
tauri-specta = { version = "2", features = ["typescript"] }
```

```rust
// main.rs
use tauri_specta::{ts, collect_commands};

fn main() {
    #[cfg(debug_assertions)]
    ts::export(
        collect_commands![get_user_profile, create_user],
        "../src/lib/bindings.ts"
    ).unwrap();
}
```

---

## Anti-Pattern da Evitare

```typescript
// MAI: Conversione manuale
const profile = await invoke("get_user_profile", { user_id: 1 });
const userId = (profile as any).user_id; // BUG: è userId!

// SEMPRE: Usa bindings generati
const profile = await getUserProfile(1);
console.log(profile.userId); // Type-safe!
```

---

## Troubleshooting

| Problema | Soluzione |
|----------|-----------|
| Type mismatch frontend/backend | Rigenera bindings con specta |
| user_id undefined | Verifica serde rename_all |
| Command not found | Registra in invoke_handler |
| Compilation error specta | Aggiungi #[specta::specta] decorator |

---

## Riferimenti
- File contesto: docs/context/CLAUDE-BACKEND.md
- Ricerca: tauri-ipc-specialist.md (Enterprise guide)
